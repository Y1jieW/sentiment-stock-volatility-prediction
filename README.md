# 利用特朗普社交媒体上的政治情绪预测股市波动
# Stock Market Volatility Prediction Using Political Sentiment from Trump’s Social Media

## 摘要
本项目以特朗普两任期社交媒体文本为政治情绪来源，结合市场技术指标，构建支持向量机（SVM）模型识别标普 500 指数基金 SPY 的高波动交易日。情绪由 FinBERT 提取为日级特征并与价格特征融合。调参与阈值校准后，模型在测试集对高波动日的召回率约 0.57，F1 约 0.62，ROC-AUC 约 0.79，相比仅用价格特征的基线模型在风险识别上显著提升。研究表明，领导人发布的政治情绪可以作为市场波动的有效早期信号。

## 背景与研究问题
金融市场不仅受基本面影响，还会受到政治沟通中情绪语调的扰动。项目聚焦两个问题：第一，来自总统级别政治沟通的情绪信号能否预测高波动交易日。第二，将政治情绪特征与价格特征融合，是否优于仅基于历史价格的基线模型。

## 数据与特征
文本数据来自特朗普两任期的社交媒体发文，总量约 26,148 条，覆盖 2017/01/20–2021/01/08 与 2025/01/20–2025/07/20 的在任期内信息流。市场数据选取 SPY 的日频收盘价与派生的滚动波动率与前一日收益。文本经清洗后用 FinBERT（yiyanghkust/finbert-tone）打分，聚合为日级正向、负向与中性占比及总量，并与价格特征按交易日对齐。

## 方法与实现
采用 scikit-learn 的 SVC 分类器，以是否为“高波动日”为二分类目标。训练流程先构建仅含价格特征的基线模型，再引入情绪特征，随后通过 TimeSeriesSplit 与 GridSearch 进行超参数搜索，并设置 class_weight=balanced 以缓解类别不平衡。最后依据 PR 曲线进行阈值校准以权衡召回与精准。最佳配置倾向于线性核与较大的正则强度（示例：kernel=linear, C≈10），显示在情绪与价格融合后的特征空间中，线性分隔具备良好泛化。

## 主要结果
在与基线一致的数据划分与评估标准下，调参与阈值校准后的模型在测试集上整体准确率约 0.78，ROC-AUC 约 0.79。更关键的是，高波动类的召回从基线的大约 0.39 提升到约 0.57，F1 从约 0.49 提升到约 0.62，实现对少数类风险事件更敏感而不过度牺牲精准。基于 PR 曲线的最优阈值下，模型在更高召回区间仍保持可接受的精准度，这对于风险管理中的预警更具实际意义。

| 指标（测试集，高波动类） | 基线（仅价格） | 融合情绪并调参 |
|---|---:|---:|
| Recall | 0.39 | 0.57 |
| Precision | 0.66 | 0.67 |
| F1-score | 0.49 | 0.62 |
| ROC-AUC（总体） | 0.74 | 0.79 |
| Accuracy（总体） | 0.74 | 0.78 |

以上数值来自文章的实验节选，具体混淆矩阵、PR/ROC 曲线与最优阈值选择过程在正文图表中有完整展示。

## 目录约定
建议目录包含 notebooks（分析与可视化）、scripts（训练与评估）、data（示例数据与链接说明）、results（图表与指标表）。仓库不直接包含超大原始数据或受平台条款约束的完整文本，仅保留小样本或数据获取脚本，并在 README 中提供复现实验的说明。

## 快速开始
首先安装 Python 依赖并准备数据。若使用示例数据与脚本，可在终端进入仓库根目录后执行如下命令。命令仅为参考，请根据实际脚本与路径调整。

```bash
pip install -r requirements.txt
python scripts/data_cleaning.ipynb    # 对原始数据集进行清洗
python scripts/FinBERT_sentiment.ipynb    # 调用 FinBERT 对清洗后的文本打分并聚合到日级
python scripts/描述性统计分析.ipynb            # 对数据集进行描述性统计
python scripts/SVM波动率预测.ipynb       # 合并特征并标准化,训练基线与融合情绪的SVM，含网格搜索与TimeSeriesSplit,生成混淆矩阵、PR/ROC 曲线与指标表
python scripts/robustness_tests.ipynb             # 对于SVM预测模型进行稳健型分析：模型切换和变量滞后
